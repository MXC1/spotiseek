[tool.ruff]
# Target Python 3.10+ for modern syntax support
target-version = "py310"
line-length = 120

# Exclude common directories that should not be linted
exclude = [
    ".git",
    ".venv",
    "venv",
    "__pycache__",
    ".pytest_cache",
    "*.egg-info",
    "build",
    "dist",
    "node_modules",
    "slskd_docker_data",
    "database",
    "observability",
]

[tool.ruff.lint]
# Enable comprehensive linting rules
select = [
    "E",      # pycodestyle errors
    "W",      # pycodestyle warnings
    "F",      # Pyflakes (unused imports, variables, etc.)
    "I",      # isort (import sorting)
    "B",      # flake8-bugbear (common bugs and design problems)
    "C4",     # flake8-comprehensions (simplify comprehensions)
    "UP",     # pyupgrade (modern Python syntax)
    "SIM",    # flake8-simplify (simplify code)
    "PIE",    # flake8-pie (misc lints)
    "RUF",    # Ruff-specific rules
    "PL",     # Pylint rules (code smells, complexity)
    "PERF",   # Perflint (performance issues)
]

# Rules to ignore (with justification)
ignore = [
    "E501",    # Line too long - handled by formatter
    "E402",    # Module level import not at top - needed for env loading before imports
    "PLR0913", # Too many arguments - acceptable for some functions
    "PLR2004", # Magic value comparison - acceptable for constants
    "PLW0603", # Global statement - needed for singleton patterns
    "PLW0602", # Global without assignment - needed for database module pattern
    "PLR0912", # Too many branches - acceptable for complex workflows
    "PLR0915", # Too many statements - acceptable for workflow functions
    "PLC0415", # import inside function - intentional for lazy loading and circular import prevention
    "PERF203", # try-except in loop - acceptable for error isolation in batch processing
    "PERF401", # list comprehension - not always clearer for complex transformations
    "SIM105",  # contextlib.suppress - try-except-pass is often more readable
]

# Allow autofix for all enabled rules
fixable = ["ALL"]
unfixable = []

[tool.ruff.lint.per-file-ignores]
# Test files can have more relaxed rules
"tests/*" = ["PLR2004", "S101"]

[tool.ruff.lint.isort]
known-first-party = ["scripts"]
